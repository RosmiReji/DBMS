CREATE TABLE BRANCH
(
BID INT,
BRANCH_NAME VARCHAR(25),
BRANCH_CITY VARCHAR(25),
ASSETS INT
);
drop table branch;
CREATE TABLE ACCOUNTS
(
ACCNO INT,
BID INT,
BALANCE INT
);
/*DROP TABLE ACCOUNTS;*/

CREATE TABLE DEPOSITORS
(
CID INT,
ACCNO INT
);
DESC DEPOSITORS;
DROP TABLE DEPOSITORS;


CREATE TABLE CUSTOMAR
(
CID INT,
CUSTOMER_NAME VARCHAR(25),
CUSTOMER_STREET VARCHAR(25),
CUSTOMER_CITY VARCHAR(25)
);
DROP TABLE CUSTOMAR;

ALTER TABLE BRANCH ADD PRIMARY KEY (BID);
ALTER TABLE ACCOUNTS ADD PRIMARY KEY (ACCNO);
ALTER TABLE CUSTOMAR ADD PRIMARY KEY (CID);

ALTER TABLE ACCOUNTS ADD FOREIGN KEY (BID) REFERENCES BRANCH(BID);
ALTER TABLE DEPOSITORS ADD FOREIGN KEY (CID) REFERENCES CUSTOMAR(CID);
ALTER TABLE DEPOSITORS ADD FOREIGN KEY (ACCNO) REFERENCES ACCOUNTS(ACCNO);

INSERT INTO BRANCH(BID,BRANCH_NAME,BRANCH_CITY,ASSETS) VALUES
(1,'MAIN','C1',10000),
(2,'B2','C2',20000),
(3,'B3','C3',30000),
(4,'B4','C4',40000),
(5,'B5','C5',50000);
SELECT * FROM BRANCH;

INSERT INTO ACCOUNTS(ACCNO,BID,BALANCE) VALUES
(101,'1',1000),
(102,'1',2000),
(103,'1',3000),
(104,'2',4000),
(105,'2',5000),
(106,'3',4000),
(107,'3',3000),
(108,'4',2000),
(109,'4',3000),
(110,'5',2000),
(111,'5',10000);
SELECT * FROM ACCOUNTS;

INSERT INTO DEPOSITORS(CID,ACCNO) VALUES
(11,101),
(22,102),
(11,103),
(33,104),
(11,105),
(44,106),
(11,107),
(55,108),
(11,109),
(44,110),
(55,111);
SELECT * FROM DEPOSITORS;

INSERT INTO CUSTOMAR(CID,CUSTOMER_NAME,CUSTOMER_STREET,CUSTOMER_CITY) VALUES
(11,'CUST1','S1','CITY1'),
(22,'CUST2','S2','CITY2'),
(33,'CUST3','S3','CITY3'),
(44,'CUST4','S4','CITY4'),
(55,'CUST5','S4','CITY5');
SELECT * FROM CUSTOMAR;

#1
SELECT CUSTOMAR.CID,CUSTOMeR_NAME,BRANCH_NAME FROM BRANCH,CUSTOMAR,DEPOSITORS,ACCOUNTS WHERE CUSTOMAR.CID=DEPOSITORS.CID AND 
DEPOSITORS.ACCNO=ACCOUNTS.ACCNO AND ACCOUNTS.BID=1 GROUP BY ACCOUNTS.BID HAVING COUNT(ACCOUNTS.BID)>=2;

#2
SELECT CUSTOMAR.CID,CUSTOMER_NAME,ACCOUNTS.ACCNO,BRANCH_CITY FROM ACCOUNTS,BRANCH,DEPOSITORS,CUSTOMAR WHERE 
BRANCH.BID=ACCOUNTS.BID AND ACCOUNTS.ACCNO=DEPOSITORS.ACCNO AND DEPOSITORS.CID=CUSTOMAR.CID AND BRANCH.BRANCH_CITY='C3'
GROUP BY DEPOSITORS.CID HAVING COUNT(DISTINCT BRANCH.BID)=(SELECT COUNT(BID) FROM BRANCH WHERE BRANCH_CITY='C3');

#3
SELECT * FROM BRANCH WHERE ASSETS=(SELECT MAX(ASSETS) FROM BRANCH);

#4
SELECT CUSTOMAR.CID,CUSTOMER_NAME,ACCOUNTS.ACCNO,BALANCE FROM CUSTOMAR,DEPOSITORS,ACCOUNTS 
WHERE CUSTOMAR.CID=DEPOSITORS.CID AND DEPOSITORS.ACCNO=ACCOUNTS.ACCNO AND BALANCE=(SELECT MAX(BALANCE) FROM ACCOUNTS);



